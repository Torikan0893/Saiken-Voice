# Next.js移行プロジェクト - 要件とタスク定義

## プロジェクト概要

イベントサイト（#再見ボイス）をVite + React + TypeScriptからNext.js（Pages Router）に安全に移行する。

### 基本情報
- **規模**: 4ページの小規模サイト
- **現在のデプロイ**: Vercel
- **目的**: パフォーマンス改善、SEO改善、保守性向上
- **制約**: 機能とデザインを一切崩してはいけない

## 現在の技術構成

### フロントエンド
- **フレームワーク**: Vite + React 18 + TypeScript
- **ルーティング**: React Router v6 (createBrowserRouter)
- **スタイリング**: SCSS + CSS
- **画像**: WebP形式（既に最適化済み）
- **デプロイ**: Vercel（静的サイトホスティング）

### ファイル構成
```
src/
├── App.tsx                 # React Routerのルート定義
├── main.tsx               # エントリーポイント
├── App.css                # グローバルスタイル
├── pages/
│   ├── index.tsx          # トップページ
│   ├── about.tsx          # Aboutページ  
│   ├── cast.tsx           # キャストページ
│   └── kowairo_info.tsx   # 企画詳細ページ
├── components/
│   ├── header.tsx         # 共通ヘッダー
│   └── footer.tsx         # 共通フッター
└── styles/
    ├── index.scss
    ├── about.scss  
    ├── cast.scss
    ├── kowairo_info.scss
    ├── header.css
    └── footer.css

public/
├── cast/                  # キャスト画像（12枚のWebP）
├── kowairo/              # 企画関連画像
├── characters.webp       # メイン画像
├── logo.webp            # ロゴ  
├── ogp.webp             # OGP画像
└── その他画像ファイル
```

### 重要な既存機能
1. **スクロール連動背景** - index.htmlにJavaScriptで実装
2. **OGPメタタグ** - index.htmlで静的設定
3. **レスポンシブ対応** - SCSS/CSSで実装
4. **画像最適化** - 既にWebP形式

## 移行先の技術構成

### 移行後のフレームワーク
- **Next.js** (最新安定版)
- **Pages Router** (App Routerではない - シンプルさを重視)
- **Static Site Generation (SSG)** - `output: 'export'`
- **TypeScript** 継続

### 移行後のファイル構成
```
src/
├── pages/
│   ├── _app.tsx          # App.tsxの代替 + CSS読み込み
│   ├── _document.tsx     # HTML構造 + メタタグ + 背景要素
│   ├── index.tsx         # / (export default化)
│   ├── about.tsx         # /about (export default化)
│   ├── cast.tsx          # /cast (export default化)  
│   └── kowairo.tsx       # /kowairo (名前変更)
├── components/           # 既存のまま
└── styles/              # 既存のまま or Tailwind移行

public/                   # 既存のまま
```

## 移行要件

### 必須要件（これらは絶対に崩してはいけない）
1. **全ページの表示内容** - 1ピクセルも変わってはいけない
2. **全CSS/SCSS** - スタイリングが完全に同じであること
3. **画像表示** - 全ての画像が正しい位置・サイズで表示される
4. **レスポンシブ動作** - モバイル・デスクトップでの表示が同一
5. **背景スクロール機能** - 既存のスクロール連動背景を維持
6. **URL構造** - `/`, `/about`, `/cast`, `/kowairo` 
7. **OGP設定** - SNSシェア時の画像・テキストが同一

### 改善要件
1. **パフォーマンス向上** - 初回ロード高速化
2. **SEO改善** - SSGによるクローラビリティ向上  
3. **Next.js Image最適化** - 可能であれば導入
4. **Tailwind CSS移行** - 可能であれば実施

## AI自動化タスク定義

### Phase 1: 現状分析
- [ ] 全ファイルの詳細な内容確認
- [ ] 依存関係の完全な把握
- [ ] CSS/SCSSの使用状況分析
- [ ] 画像パスの使用状況確認
- [ ] React Routerのルート構成確認

### Phase 2: 移行設計
- [ ] Next.js設定ファイルの設計 (`next.config.mjs`)
- [ ] `_app.tsx`の設計（CSS統合方法）
- [ ] `_document.tsx`の設計（メタタグ + 背景JS移行）
- [ ] 各ページコンポーネントの変更設計
- [ ] 画像パス修正方針の決定

### Phase 3: 実装・テスト
- [ ] package.jsonの変更
- [ ] 新しいファイル構成での実装
- [ ] 各ページの動作確認
- [ ] スタイリングの完全一致確認  
- [ ] 画像表示の確認
- [ ] 背景スクロール機能の確認
- [ ] レスポンシブ動作の確認

### Phase 4: 最終確認
- [ ] 全URL（4ページ）での表示確認
- [ ] デスクトップ/モバイルでの表示比較
- [ ] OGP確認
- [ ] ビルド・デプロイテスト

## 注意事項とリスク

### 高リスク項目
1. **背景スクロールJS** - DOM操作の移行が複雑
2. **CSS/SCSSの読み込み順序** - スタイル崩れのリスク
3. **画像パス** - public/配下のパス変更による表示エラー
4. **コンポーネント間のCSS影響** - グローバルCSS競合

### 回避策
1. **段階的移行** - 1ページずつ動作確認
2. **ビジュアル比較** - スクリーンショット自動比較
3. **バックアップ保持** - 元のVite構成を完全保持
4. **Vercelプレビュー** - 本番環境での確認

## 成功指標

### 必達指標
- [ ] 全ページが既存と**完全に同じ見た目**で表示される
- [ ] 全機能（スクロール背景等）が正常動作する  
- [ ] モバイル・デスクトップで既存と同じレスポンシブ動作
- [ ] OGP情報が正しく設定される

### 改善指標
- [ ] Lighthouse Performanceスコア向上
- [ ] 初回ロード時間短縮
- [ ] SEO改善（meta descriptionの動的化等）

---

## AIエージェントへの指示

このドキュメントを基に、以下を実行してください：

1. **徹底的な現状分析** - 全ファイルを精査し移行影響を特定
2. **安全な移行計画** - リスクを最小化した段階的実装
3. **完全性の保証** - 移行前後で機能・デザインが100%同一であることの確認
4. **自動テスト** - 可能な限り表示・機能テストを自動化

**最重要**: このサイトは公開中のイベントサイトです。一切の機能破損・デザイン変更は許可されません。
